<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Les <i>data frames</i>s</title>
  <link href="https://philippe-preux.github.io/css/ma.css" 
	rel="stylesheet" type="text/css" media="all" />
  <link rel="shortcut icon" type="image/x-icon" 
	href="https://philippe-preux.github.io/img/site.ico" />
</head>

<body>
<div class="tpR">

  <h1>Classification supervisée</h1>
  
  <p>

    Dans ce TP, on va aborder la classification supervisée en la mettant en &oelig;uvre sur le jeu de données <kbd>olives</kbd>.

    <br/>

    Les 2 TPs précédents (<a href="../df">tableaux de données</a> et <a href="../graphiques">graphiques</a>) doivent avoir été faits.

  </p>

  <h2>Introduction</h2>
    
  <p>

    Les olives du jeu de données proviennent chacune d'une région particulière d'Italie&nbsp;: nord, sud, Sardaigne. Celles-ci sont numérotées et la valeur associée à chaque olive est dans l'attribut 1 dénommé <kbd>region</kbd>. Chaque région est découpée en sous-régions&nbsp;; cette sous-région est dans les attributs 0 et 2&nbsp;; l'attribut 2 est juste le numéro de la sous-région dont le nom est donné par l'attribut 0. La carte ci-dessous indique ces régions et certaines sous-régions.
    
  </p>
  
  <img src="./olives-italie.png" width="400pt"/>

  <p>

    Chaque olive étant par ailleurs caractérisée par sa teneur en certains acides, la question que nous étudions dans ce TP est&nbsp;: à partir de cette composition chimique, peut-on déterminer la provenance de l'olive&nbsp;?

    <br/>

    Si on arrive à déterminer la provenance à partir de la composition chimique de l'olive, on peut garantir que la provenance indiquée est la bonne et pourquoi pas, détecter ainsi des tentatives de fraudes si ce n'est pas le cas.

  </p>

  <h2>Premiers pas&nbsp;: approche graphique (exploration visuelle des données)</h2>

  <p>

    Face à un jeu de données, la première chose à faire et de l'explorer visuellement. Dans le cas où on souhaite prédire la valeur d'un attribut, on se pose la question&nbsp;: la réponse à la question qui est posée saute-t-elle aux yeux&nbsp;?

    <br/>

    Donc, on commence par faire des graphiques très simples pour voir s'il est possible de prédire la région de provenance de l'olive.

    On commence par la région car il y a 3 régions qui se découpent en 8 zones. Il est donc probablement plus facile de déterminer la région que la zone.

    <br/>

    Outre voir les choses, cette exploration visuelle permet de choisir un modèle pour réaliser la tâche de prédiction&nbsp;: si on voit des relations simples, on sait que des modèles simples pourront réaliser les prédictions voulues.
    
  </p>
  
  <h3>Visualisation univariée&nbsp;: répartition des valeurs de chaque attribut en fonction de sa classe</h3>
  
  <p>

    Par graphique très simple, on entend la visualisation de la répartition de la valeur d'un attribut (= univarié) en fonction de sa classe. Pour chaque acide, on réalise un graphique comme celui-ci pour l'attribut <kbd>palmitic</kbd>&nbsp;:

  </p>

  <p class="aligncenter">
    <img src="palmitic-par-classe.png" width="500pt" align="middle" />
  </p>

  <ul>
    <li>En abscisses, c'est le numéro de la donnée (la ligne dans le jeu de données)&nbsp;;</li>
    <li>en ordonnées, la valeur de l'attribut <kbd>palmitic</kbd>&nbsp;;</li>
    <li>la couleur indique la région&nbsp;:
      <ol>
	<li>sud de l'italie en bleu&nbsp;;</li>
	<li>Sardaigne en rose&nbsp;;</li>
	<li>nord de l'italie en jaune.</li>
      </ol></li>
  </ul>

  <p>

    D'un coup d'&oelig;il, on voit que cet attribut ne permet pas de distinguer les olives des 3 classes. En effet, quand on considère une valeur de l'acide palmitique supérieure à 1400, on voit que l'on peut en déduire que l'olive provient de la zone 1&nbsp;: il n'y a que des points bleus à ces ordonnées. Par contre, si cette valeur est comprise entre 1000 et 1200, les 3 classes sont possibles&nbsp;: pour ces ordonnées, on voit des points des 3 couleurs.

    <br/>

    En conclusion, l'attribut <kbd>palmitic</kbd> ne permet pas de déterminer la région d'origine de l'olive.

    <br/>
    <br/>

    <b>À faire&nbsp;:</b> réalisez ce graphique pour chacun des 8 acides et concluez. Y a-t-il un, ou des attributs, qui permet de déterminer la région d'origine&nbsp;? ou qui peut aider&nbsp;?

    <br/>

    Remarque&nbsp: pour réaliser ce graphique, j'ai ajouté une colonne <kbd>numero</kbd> au tableau de données <kbd>olives</kbd>. Cette colonne contient tout simplement le numéro de la donnée.
    
  </p>

  <h3>Visualisation bivariée</h3>

  <p>

    «&nbsp;Bivariée&nbsp» signifie que l'on considère deux attributs.
    L'idée est ici la même que précédemment, mais au lieu de chercher une relation entre un attribut et la classe, on cherche une relation entre un couple d'attributs et la classe.

    <br/>

    Reprenons le schéma réalisé à la fin du TP précédent&nbsp;:
    
  </p>

  <img src="../graphiques/olives-palmitic-vs-oleic-against-region.png" width="500pt" />

  <p>

    On voit que ces deux attributs ne permettent pas de déterminer la classe de manière simple&nbsp;: les points des 3 couleurs sont mélangés.

    <br/>

    On peut quand même voir que pour une valeur de l'acide oléique inférieure à (environ) 7200, l'acide palmitique permet à peu près de bien prédire la classe 1 ou 3. Cela ne répond pas à notre question, mais c'est un élément d'information.
    
  </p>

  
  <h2>Approche automatique</h2>

  <p>

    Même si nous avons vu des relations en faisant nos graphiques, nous avons vu que la solution ne saute pas aux yeux. Nous allons donc essayer de prédire la région d'origine de l'olive à l'aide de méthode qui ont pour objectif d'apprendre un modèle réalisant ce type de prédiction.

    <br/>
    <br/>

    Face à un jeu de données de petite taille comme celui-ci (quelques centaines de lignes, une dizaine de colonnes), on commence par tester les arbres de décision. C'est ce que nous allons faire.

    <br/>
    <br/>

    Pour cela, on va utiliser la bibliotèque <kbd>scikit_learn</kbd> qu'il vous faut donc importer. Pour pouvoir créer des arbres de décision, on fera&nbsp;: <kbd>from sklearn import tree</kbd>.

    <br/>

    La documentation est <a href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.tree">là</a>.
    
  </p>

  
  <h3>Induction d'un arbre de décision</h3>

  <p>

    Induction

    <br/>

  </p>

  <ul>
    <li>On lance l'algo et on voit.</li>
    <li>train/test split</li>
    <li>Si ça ne marche pas, on devra réflêchir aux paramètres...</li>
  </ul>
    

  <h3>Diagnostic de l'arbre de décision</h3>

  <ul>
    <li>taux d'erreur</li>
    <li>certaines classes mieux prédites que d'autres</li>
  </ul>
  
  <p>

    
  </p>
  
  <h3>Interprétation d'un arbre de décision</h3>

  <p>

    On peut obtenir une visualisation de l'arbre de décision en faisant par exemple&nbsp;:
    
  </p>

<pre>import matplotlib as mpl
import matplotlib.pyplot as plt
fig, ax = plt.subplots ()
tree.plot_tree (arbre)
fig.show ()
</pre>

  <p>
    
    qui ouvre une fenêtre avec le graphique suivant&nbsp;:

  </p>
  
  <img src="arbre-region.png" width="500pt" />

  <p>
    
    <b>À faire&nbsp;:</b> réalisez ce graphique et le comprendre. En particulier, comprendre ce qui est affiché dans chaque n&oelig;ud.

    <br/>
    <br/>

    Les tests réalisés à chaque n&oelig;ud sont difficile à comprendre. Pour afficher le nom des attributs, on ajoutera <kbd>feature_names = list (X_test)</kbd> dans l'appel de la méthode <kbd>plot_tree()</kbd>. Et on obtient&nbsp;:
    
  </p>

  <img src="arbre-region-avec-le-nom-des-attributs.png" width="500pt" />

  <p>

    En consultant <a hef="https://scikit-learn.org/stable/modules/tree.html#tree">la documentation</a>, on peut avoir une représentation plus jolie et informative avec la classe prédite qui est indiquée dans chaque feuille, comme celle-ci&nbsp;:

  </p>
  
  <img src="arbre-region-plus-joli.png" width="500pt" />

  <p>

    <b>Faites-le.</b>
    
  </p>
  
  <h3>Test de l'arbre de décision</h3>

  <p>

    Nous avons construit un arbre de décision qui donne de très bons résultats. Est-ce juste de la chance ou est-ce que décidément, cette tâche se résout facilement à l'aide d'un arbre de décision&nbsp;?

    reproductibilité et multiples runs
    
  </p>
  
  <h2>yyy</h2>

  <p>

  </p>

  <h2>Pour finir...</h2>

  <p>

    Refaites le même travail pour prédire l'attribut <kbd>area</kbd>.
    
  </p>
  
</div>

</body>
</html>
