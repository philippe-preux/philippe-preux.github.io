<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Correction du contrôle 1</title>
  <link href="https://philippe-preux.github.io/css/ma.css" 
	rel="stylesheet" type="text/css" media="all" />
  <link rel="shortcut icon" type="image/x-icon" 
	href="https://philippe-preux.github.io/img/site.ico" />
</head>

<body>
<div class="tpR">

  <h1>Correction du contrôle 1</h1>
  <h3>Science des données 2
    <br/>
    L3 MIASHS, 16 octobre 2023
    <br/>
    Tout document autorisé
    <br/>
    Durée&nbsp;: 1h45</h3>

  <div class="correction">
    <p>
      Concernant les commandes python à effectuer pour répondre aux questions, il n'y a pas une et une seule bonne réponse aux questions. J'en indique une.
    </p>
  </div>

  <h2>Énoncé</h2>

  <p>

    Nous allons étudier un jeu de données qui contient de nombreuses éruptions volcaniques connues s'étant déroulées dans les 14000 dernières années. Les données sont ordonnées de l'éruption la plus récente à la plus ancienne.

    <br/>

    Ce fichier est disponible à l'url <kbd>https://philippe-preux.github.io/ensg/miashs/datasets/eok.csv</kbd>.

    <br/>

    Pour chaque éruption, le jeu de données indique&nbsp;:

  </p>

  <ul>
    <li>le numéro du volcan concerné&nbsp;;</li>
    <li>le nom du volcan&nbsp;;</li>
    <li>le numéro d'éruption&nbsp;;</li>
    <li>le type d'éruption&nbsp;;</li>
    <li>la zone d'activité du volcan&nbsp;;</li>
    <li>l'indice d'explositivité de l'éruption (<i>Volcanic explosivity index</i>)&nbsp;;</li>
    <li>la date de début d'éruption&nbsp;;</li>
    <li>la méthode utilisée pour dater l'éruption&nbsp;;</li>
    <li>la date de fin de l'éruption&nbsp;;</li>
    <li>la latitude du volcan&nbsp;;</li>
    <li>la longitude du volcan&nbsp;;</li>
    <li>le pays où est situé le volcan.</li>
  </ul>
  
  <p>

    Les questions&nbsp;:

  </p>

  <ol>
    <li>quelle commande effectuez-vous pour charger le jeu de données&nbsp;? Faites-le et indiquez-la dans le compte-rendu.
      <div class="correction">
	<pre>
eok = pd.read_csv ("https://philippe-preux.github.io/ensg/miashs/datasets/eok.csv")</pre>
      </div>
    </li>
    <li>Quelle commande effectuez-vous pour connaître le nombre de données contenues dans ce jeu de données&nbsp;? Indiquez ce nombre dans le compte-rendu.
      <div class="correction">
	<pre>
eok.shape [0]
# 9559</pre>
      </div>
    </li>
    <li>Quelle commande effectuez-vous pour connaître le nombre d'attributs décrivant les données&nbsp;? Indiquez ce nombre dans le compte-rendu.  <div class="correction">
	<pre>
eok.shape [1]
# 16</pre>
</div></li>
    <li>Quelle commande effectuez-vous pour obtenir la liste de ces attributs&nbsp;? Indiquez cette liste dans le compte-rendu.  <div class="correction">
	<pre>
list (eok)
# ['volcano_number', 'volcano_name', 'eruption_number', 'eruption_category', 'area_of_activity', 'vei', 'start_year', 'start_month', 'start_day', 'evidence_method_dating', 'end_year', 'end_month', 'end_day', 'latitude', 'longitude', 'country']</pre>
</div></li>
    <li>Quelle commande effectuez-vous pour obtenir l'année où a eu lieu l'éruption la plus ancienne enregistrée dans ce jeu de données&nbsp;? Indiquez cette année dans le compte-rendu.  <div class="correction">
	<pre>
min (eok["start_year"])
# -11345</pre>
      </div>
    </li>
    <li>Quelle commande effectuez-vous pour obtenir le pays dans lequel a eu lieu cette éruption&nbsp;? Indiquez ce pays dans le compte-rendu.  <div class="correction">
	<pre>
eok.loc [eok ["start_year"] == min (eok["start_year"]), "country"]
# Chile</pre>
      </div>
    </li>
    <li>Quelle commande effectuez-vous pour connaître le nombre d'éruptions qui ont eu lieu dans chaque pays&nbsp;? Indiquez-la dans le compte-rendu.  <div class="correction">
	<pre>
>>> eok["country"].value_counts ()
Japan                1653
Indonesia            1297
United States        1025
Russia                822
Chile                 521
                     ... 
Ethiopia-Djibouti       1
Colombia-Ecuador        1
Mongolia                1
Iran                    1
Saint Lucia             1
Name: country, Length: 76, dtype: int64</pre>
      </div>
    </li>
    <li>Quelle commande effectuez-vous pour connaître le pays qui a enregistré le plus grand nombre d'éruptions&nbsp;? Indiquez le pays et le nombre d'éruptions dans le compte-rendu.  <div class="correction">
	<p>
	  On a obtenu la réponse avec la commande précédente&nbsp;: Japon, 1653 éruptions.
	</p>
      </div>
    </li>
    <li>Quelle commande effectuez-vous pour connaître le nombre d'éruptions qui se sont déroulées en France&nbsp;? Indiquez ce nombre d'éruptions dans le compte-rendu.  <div class="correction">
	<pre>
eok [eok.country == "France"].shape[0]
# 285</pre>
      </div>
    </li>
    <li>Quelle(s) commande(s) effectuez-vous pour connaître les années de la plus ancienne et la plus récente éruptions qui se sont déroulées en France&nbsp;? Indiquez ces deux années dans le compte-rendu.
      <div class="correction">
	<p>
	  On peut taper la commande&nbsp;:
	</p>
	<pre>
eok.start_year [eok.country == "France"]</pre>
	<p>
	  et lire la réponse. Ou bien, on peut taper les deux commandes&nbsp;:
	</p>
	<pre>
eok.start_year [eok.country == "France"].head(1)
eok.start_year [eok.country == "France"].tail(1)</pre>
	<p>
	  qui donnent juste les réponses attendues (2020 et -8210).
	</p>
      </div>
    </li>
    <li>La célèbre éruption du Vésuve qui a detruit Pompeï est-elle dans le jeu de données&nbsp;? Elle a eu lieu en 79 et en anglais, le volcan s'appelle "Vesuvius". Quelle commande tapez-vous pour répondre à cette question&nbsp;? Si l'éruption est présente, indiquez le numéro de la donnée correspondante (le numéro de la ligne dans le jeu de données).
      <div class="correction">
	<pre>
eok [(eok.start_year  == 79) & (eok.volcano_name=="Vesuvius")]</pre>
	<p>
	  numéro 7480.
	</p>
      </div>
    </li>
    <li>Quelle commande effectuez-vous pour obtenir le nombre d'éruptions volcaniques dans le monde depuis 2000 ? Indiquez ce nombre dans le compte-rendu.
      <div class="correction">
	<pre>
eok [eok.start_year > 2000].shape[0]
# 615</pre>
      </div>
    </li>
    <li>Quelle commande effectuez-vous pour réaliser un graphique de la répartition des éruptions dans le monde (en fonction de la longitude et de la latitutde du volcan), autrement dit, cette figure&nbsp;:

      <div class="correction">
	<pre>
eok.plot.scatter (x="longitude", y = "latitude", title = "Position des éruptions volcaniques connues.", xlabel = "Longitude", ylabel = "Latitude", s = 1)</pre>
      </div>

      <img src="eruptions_connues_s_1.png" width="300pt" alt="position des éruptions volcaniques connues." />

      <br/>
      
      Insérez la figure que vous avez réalisée dans le compte-rendu.

      Comment faites-vous pour ajouter un point rouge indiquant la position de Greenwich (longitude = 0, latitude = 51°28'44")&nbsp;? Faites-le.

      <br/>
      
      <img src="eruptions_connues_avec_Greenwich.png" width="300pt" alt="position des éruptions volcaniques connues avec Greenwich en rouge." />

      <br/>

      Insérez cette autre figure dans le compte-rendu.
      
      <div class="correction">
	<pre>
eok.plot.scatter (x="longitude", y = "latitude", title = "Position des éruptions volcaniques connues.\nGreenwich indiqué par un point rouge", xlabel = "Longitude", ylabel = "Latitude", s = 1)
plt.plot (0,51+28/60+44/3600,'ro',color="red")</pre>
      </div>
    </li>
    
  <li>Les attributs <kbd>start_year</kbd>, <kbd>start_month</kbd>, <kbd>start_day</kbd> indiquent la date de début de l'éruption. Les attributs <kbd>end_year</kbd>, <kbd>end_month</kbd>, <kbd>end_day</kbd> indiquent la date de fin.
    <br/>
    Ajouter un attribut <kbd>duration</kbd> au jeu de données qui contient la durée de l'éruption. Quelle commande tapez-vous pour réaliser cela&nbsp;?
    <div class="correction">
      <p>
	Je décompose le calcul en commençant par calculer les dates de début et de fin des éruptions et ensuite, je fais la différence.
      </p>
      <pre>
eok["debut"] = pd.to_datetime (pd.DataFrame ({"year": eok.start_year, "month": eok.start_month, "day": eok.start_day}), errors = "coerce")
eok["fin"] = pd.to_datetime (pd.DataFrame ({"year": eok.end_year, "month": eok.end_month, "day": eok.end_day}), errors = "coerce")
eok ["duration"] = eok["fin"] - eok ["debut"]</pre>
    </div>
  </li>
  <li>Pour que vous ne soyez pas bloqué pour la suite, si vous ne savez pas résoudre la question précédente, vous pouvez charger le fichier qui contient cet attribut à l'url <kbd>https://philippe-preux.github.io/ensg/miashs/datasets/eok+duration.csv</kbd>.
    <br/>
    Quelle commande effectuez-vous pour connaître la plus longue éruption connue de l'histoire&nbsp;? Où s'est-elle déroulée&nbsp;? Est-elle terminée&nbsp;? Combien de temps a-t-elle duré&nbsp;? Vous indiquez la réponse à ces questions dans le compte-rendu.  <div class="correction">
      <pre>
max (eok.duration)</pre>
      <p>
	Elle s'est déroulée au Vanuatu, et s'est terminée le 17 avril 2020. Elle a donc duré 89774 jours, soit environ 246 ans.
      </p>
    </div>
  </li>
    <li>Au graphique précédent, ajouter la position de ce volcan en orange. Insérer cette nouvelle figure dans votre compte-rendu&nbsp;;
      <div class="correction">
	<pre>
eok.plot.scatter (x="longitude", y = "latitude", title = "Position des éruptions volcaniques connues.\nGreenwich indiqué par un point rouge", s = 1, xlabel = "Longitude", ylabel = "Latitude")
plt.plot (0, 51+28/60+44/3600, "ro", color="red")
plt.plot (eok.longitude [eok.duration==max(eok.duration)], eok.latitude [eok.duration==max(eok.duration)], "ro", color = "orange")</pre>
      </div>
    </li>
    <li>Pour quel volcan a-t-on le plus d'éruptions connues ? Dans quel pays est-il situé&nbsp;? Combien y en a-t-il ? De quand date la plus ancienne&nbsp;?  <div class="correction">
	<pre>
eok.volcano_name.value_counts()
eok [eok.volcano_name == "Etna"].country
eok.start_year [eok.volcano_number == 211060].tail(n=1)</pre>
	<p>
	  Il s'agît de l'Etna (1ère commande), situé en Italie (deuxième commande). 241 éruptions (1èere commande), la plus ancienne en -6190 (troisième commande).
	</p>
      </div>
    </li>
    <li>Combien d'éruptions dans la "Chaine des Puys" (utilisez ce nom pour le volcan) sont connues&nbsp;? Quelle est l'année de la plus récente&nbsp;?  <div class="correction">
	<pre>
eok.start_year [eok.volcano_name == "Chaine des Puys"]</pre>
	<p>
	  8 éruptions, la plus récente en -4040.
	</p>
      </div>
    </li>
    <li>Combien y a-t-il d'éruptions en moyenne chaque année depuis 1900&nbsp;? Faire un graphique de ce nombre au fil des années, de 1900 à 2020 comme celui-ci&nbsp;:
      <br/>
      <img src="nb_eruptions_entre_1900_et_2019.png" width="300pt" alt="Nb éruptions par année." />
      <br/>
      Insérez-le dans le compte-rendu.
      <div class="correction">
	<pre>
nb = eok.start_year [(eok.start_year >= 1900)&(eok.start_year < 2020)].value_counts()
nb.sort_index().plot(linestyle = "--", marker = "o", color = "magenta", xlabel = "Année", ylabel ="Nombre d'éruptions", title = "Nombre d'éruptions volcaniques par année.")
plt.show()</pre>
      </div>
    </li>
    <li>Faire le même graphique pour les années comprises entre 0 et maintenant. Insérez-le dans le compte-rendu. Que constatez-vous&nbsp;? Pensez-vous que cela reflète la réalité&nbsp;?  <div class="correction">
	<p>
	  On obtient ce graphique&nbsp;:
	  <br/>
	  <img src="nb_eruptions_par_annee.png" width="300pt" alt="Nombre d'éruptions volcaniques dans le jeu de données depuis 0." />
	  <br/>
	  Le graphique montre qu'avant le XIXè siècle, il y a peu d'éruptions. En fait, la réalité est qu'il y a peu d'éruptions <b>connues</b>, pas qu'il n'y en a pas eu. Donc, ce graphique représente la réalité de ce qui est connu, pas la réalité de ce qu'il s'est passé. Il n'y a aucune raison de penser que le nombre moyen d'éruptions volcaniques a varié depuis l'an 0.
	</p>
      </div>
    </li>
  </ol>
  
  
</div>

<!-- Default Statcounter code for on github
https://philippe-preux.github.io -->
<script type="text/javascript">
var sc_project=12923547; 
var sc_invisible=1; 
var sc_security="627600d4"; 
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js"
async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="https://statcounter.com/" target="_blank"><img
class="statcounter"
src="https://c.statcounter.com/12923547/0/627600d4/1/"
alt="Web Analytics"
referrerPolicy="no-referrer-when-downgrade"></a></div></noscript>
  <!-- End of Statcounter Code -->
  
</body>
</html>
